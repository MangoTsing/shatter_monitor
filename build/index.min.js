var shatter=function(t){"use strict";var e;!function(t){t.UNKNOWN="UNKNOWN",t.UNKNOWN_FUNCTION="UNKNOWN_FUNCTION",t.JAVASCRIPT_ERROR="JAVASCRIPT_ERROR",t.BUSINESS_ERROR="BUSINESS_ERROR",t.LOG_ERROR="LOG_ERROR",t.FETCH_ERROR="HTTP_ERROR",t.VUE_ERROR="VUE_ERROR",t.RESOURCE_ERROR="RESOURCE_ERROR",t.PROMISE_ERROR="PROMISE_ERROR"}(e||(e={}));class n{constructor(t){this.options=t}beforSendData(t){if(!this.options.beforSendData)return!0;try{return this.options.beforSendData(t)}catch(t){throw t}}}return t.init=class{constructor(t){var s;this.sendType="img",this.options=t,this.hooks=new n(t),window.navigator&&window.navigator.sendBeacon&&(this.sendType="beacon"),s=this,window.onerror=(t,n,r,o)=>{s.log({name:"jserror",msg:t,url:n,line:r,col:o,type:e.JAVASCRIPT_ERROR})},window.addEventListener("error",t=>{const n=t.target||t.srcElement;if(!(n instanceof HTMLScriptElement||n instanceof HTMLLinkElement||n instanceof HTMLImageElement))return!1;const r=n.src||n.href;s.log({name:"sourceError",url:r,type:e.RESOURCE_ERROR})},!0),window.addEventListener("unhandledrejection",t=>{if(!t.reason||!t.reason.stack)return void s.log({name:"unhandledrejection",type:e.PROMISE_ERROR});const n=t.reason.stack.split("\n")[1].split("at ")[1],r=n.split(":"),o=r[r.length-2],a=r[r.length-1],i=n.slice(0,-o.length-a.length-2),R=t.reason.message;s.log({name:"unhandledrejection",msg:R,url:i,line:o,col:a,type:e.PROMISE_ERROR})},!0),function(t){if(!window.XMLHttpRequest)return;const e=window.XMLHttpRequest,n=e.prototype.send,s=function(e){e&&e.currentTarget&&200!==e.currentTarget.status&&t&&t(e)};e.prototype.send=function(){if(this.addEventListener)this.addEventListener("error",s),this.addEventListener("load",s),this.addEventListener("abort",s);else{const t=this.onreadystatechange;this.onreadystatechange=function(e){4===this.readyState&&s(e),t&&t.apply(this,arguments)}}return n.apply(this,arguments)}}(t=>{const n=t.currentTarget;this.log({name:"xhrError",url:n.responseURL,type:e.FETCH_ERROR,response:{status:n.status,data:n.statusText}})}),function(t,e){if(!window.fetch)return;const n=window.fetch;window.fetch=function(){const s=arguments;return n.apply(this,arguments).then(e=>(e.ok||t&&t(e),e)).catch(t=>{throw e&&e(t.toString(),s),t})}}(t=>{this.log({name:"fetchError",url:t.url,msg:t.statusText,type:e.FETCH_ERROR,response:{status:t.status,data:t.statusText}})},(t,n)=>{const s="https"===n[0].substr(0,5)?"https":"other";this.log({name:"fetchError",msg:t,type:e.FETCH_ERROR,request:{httpType:s,data:n[1].body,method:n[1].method,url:n[0]}})})}log(t){const{dsn:e,appkey:n}=this.options;return Object.assign(t,{_t:(new Date).getTime(),appkey:n}),!1}},Object.defineProperty(t,"__esModule",{value:!0}),t}({});
