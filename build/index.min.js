var shatter=function(t){"use strict";function e(t){return Object.prototype.toString.call(t).indexOf("Error")>-1}var r,n;!function(t){t.JAVASCRIPT_ERROR="JAVASCRIPT_ERROR",t.BUSINESS_ERROR="BUSINESS_ERROR",t.LOG_ERROR="LOG_ERROR",t.FETCH_ERROR="HTTP_ERROR",t.RESOURCE_ERROR="RESOURCE_ERROR",t.PROMISE_ERROR="PROMISE_ERROR",t.VUE_ERROR="VUE_ERROR"}(r||(r={})),function(t){t.jsError="JS_ERROR",t.sourceError="SOURCE_ERROR",t.promiseError="UNHANDLEDREJECTION",t.consoleError="CONSOLE_ERROR",t.ajaxError="AJAX_ERROR",t.fetchError="FETCH_ERROR",t.VueError="VueError"}(n||(n={}));var o=function(){function t(t){this.options=t}return t.prototype.beforeSendData=function(t){if(!this.options.beforeSendData)return!0;try{return this.options.beforeSendData(t)}catch(t){throw t}},t}();function i(t){var e=t.substr&&t.substr(0,5);return e?"https"===e?"https":"http:"===e?"http":"other":"unknown"}var a=function(){function t(t){this.sendType="img",this.options=t,this._init()}var a=t.prototype;return a._init=function(){var t=this,a=this.options,s=a.blockConsole,c=a.blockPromise,p=a.blockError,u=a.blockSource,l=a.blockXhr,f=a.blockFetch,h=a.blockTry,R=a.blockHttpRequest,E=a.onlyHttpRequest;this.hooks=new o(a),window.navigator&&window.navigator.sendBeacon&&!a.onlyImg&&(this.sendType="beacon"),E||function(t,o){if(!o.blockTry){var i=EventTarget.prototype.addEventListener,a=EventTarget.prototype.removeEventListener,s=[];EventTarget.prototype.addEventListener=function(t,e,r){var n=function(){try{return e.apply(this,arguments)}catch(t){throw t}};return s.push({origin:e,wrap:n}),i.call(this,t,n,r)},EventTarget.prototype.removeEventListener=function(t,e,r){var n;return s.some((function(t){return t.origin===e&&(n=t.wrap,!0)}))?a.call(this,t,n,r):a.call(this,t,e,r)}}if(!o.blockError){var c=window.onerror||null;window.onerror=function(e,o,i,a,s){t.report({name:n.jsError,msg:e,url:o,line:i,col:a,type:r.JAVASCRIPT_ERROR}),c&&c(e,o,i,a,s)}}if(o.blockSource||window.addEventListener("error",(function(e){if(e){var o=e.target||e.srcElement;if(!(o instanceof HTMLScriptElement||o instanceof HTMLLinkElement||o instanceof HTMLImageElement))return!1;var i=o.src||o.href;t.report({name:n.sourceError,url:i,type:r.RESOURCE_ERROR})}}),!0),o.blockPromise||window.addEventListener("unhandledrejection",(function(e){if(e.reason&&e.reason.stack&&e.reason.stack.includes("\n")){var o=e.reason.stack.split("\n")[1].split("at ")[1],i=o.split(":"),a=i[i.length-2],s=i[i.length-1],c=o&&o.slice(0,-a.length-s.length-2),p=e.reason.message;t.report({name:n.promiseError,msg:p,url:c,line:a,col:s,type:r.PROMISE_ERROR})}else t.report({name:n.promiseError,type:r.PROMISE_ERROR,msg:e.reason&&e.reason.stack||e.reason||""})}),!0),!o.blockConsole){var p=window.console.error;window.console.error=(u=p,function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];i.forEach((function(o){if(e(o)){var i,a=(i=o.stack&&o.stack.split("\n")[1]?o.stack&&o.stack.split("\n")[1].split("at ")[1]:o.stack).split(":"),s=a[a.length-2],c=a[a.length-1],p=i.split("(")[1]&&i.split("(")[1].slice(0,-s.length-c.length-2)||"anonymousFunction";t.report({name:n.consoleError,msg:o.stack,url:p,line:s,col:c,type:r.LOG_ERROR})}else t.report({name:n.consoleError,msg:o,type:r.LOG_ERROR})})),u.apply(console,i)})}var u}(this,{blockConsole:s,blockPromise:c,blockError:p,blockSource:u,blockTry:h}),R||(l||function(t){if(window.XMLHttpRequest){var e=window.XMLHttpRequest,r=e.prototype.send,n=e.prototype.open,o=function(e,r,n,o){e&&e.currentTarget&&200!==e.currentTarget.status&&t&&t(e,r,n,o)};e.prototype.open=function(){var t=arguments;return this._openArgs=t,this._openTime=(new Date).getTime(),n.apply(this,t)},e.prototype.send=function(){var t=arguments;if(this.addEventListener)this.addEventListener("error",(function(e){o(e,t,this._openArgs,this._openTime)})),this.addEventListener("load",(function(e){o(e,t,this._openArgs,this._openTime)})),this.addEventListener("abort",(function(e){o(e,t,this._openArgs,this._openTime)}));else{var e=this.onreadystatechange;this.onreadystatechange=function(r){4===this.readyState&&o(r,t,this._openArgs,this._openTime),e&&e.apply(this,t)}}return r.apply(this,t)}}}((function(e,o,a,s){var c=e.currentTarget,p=c.responseURL,u=(new Date).getTime()-s;t.report({name:n.ajaxError,url:p,type:r.FETCH_ERROR,fetchTimeline:u,request:{method:a[0],httpType:i(p),data:o&&o[0]||""},response:{status:c.status,data:c.statusText}})})),f||function(t,e){if(window.fetch){var r=window.fetch;window.fetch=function(){var n=arguments,o=(new Date).getTime();return r.apply(this,n).then((function(e){return e.ok||t&&t(e,n,o),e})).catch((function(t){throw e&&e(t.toString(),n,o),t}))}}}((function(e,o,a){e.text().then((function(s){var c=e.url||o[0],p=(new Date).getTime()-a;t.report({name:n.fetchError,url:c,msg:e.statusText,type:r.FETCH_ERROR,fetchTimeline:p,request:{httpType:i(c),method:o[1].method,data:o[1].body||""},response:{status:e.status,data:s||e.statusText}})}))}),(function(e,o,a){var s=i(o[0]),c=(new Date).getTime()-a;t.report({name:n.fetchError,msg:e,url:o[0],fetchTimeline:c,type:r.FETCH_ERROR,request:{httpType:s,data:o[1].body,method:o[1].method}})})))},a.report=function(t){var e=this.options,r=e.dsn,n=e.appkey;if(Object.assign(t,{_t:(new Date).getTime(),appkey:n}),!this.hooks.beforeSendData(t))return!1;var o,i,a=(o=t,Object.entries(o).reduce((function(t,e,r){var n=e[0],o=e[1];return"object"==typeof o&&(o=JSON.stringify(o)),0!==r&&(t+="&"),t+=n+"="+encodeURIComponent(o)}),""));this.options.debug?console.log("log to : "+r+"?"+a):"img"===this.sendType?(i=r+"?"+a,(new Image).src=i):"beacon"===this.sendType&&function(t,e){if(void 0===e&&(e="formData"),"formData"===e){var r=new FormData;for(var n in t)if("dsn"!==n){var o=t[n];"object"==typeof o&&(o=JSON.stringify(o)),r.append(n,o)}window.navigator.sendBeacon(t.dsn,r)}}(Object.assign(t,{dsn:r}))},t}(),s=function(){function t(){console.log("performance")}return t.prototype.init=function(){console.log("performance init")},t}(),c=function(){function t(){console.log("behavior")}return t.prototype.init=function(){console.log("behavior init")},t}();function p(t,e,o){var i=function(t){if(t.$root===t)return"root";var e=t._isVue?t.$options&&t.$options.name||t.$options&&t.$options._componentTag:t.name;return(e?"component <"+e+">":"anonymous component")+(t._isVue&&t.$options&&t.$options.__file?" at "+(t.$options&&t.$options.__file):"")}(e),a=e.$options&&e.$options.propsData;return{type:r.VUE_ERROR,msg:t.message+"("+o+")",url:"undefined"==typeof document||null==document.location?"":document.location.href,componentName:i,propsData:a||"",name:n.VueError,stack:t.stack||[]}}var u=function(){function t(){}return t.install=function(t,e){var r=new a(e);t.prototype.$report=r.report;var n=function(t){var e="object"==typeof t?JSON.stringify(t):t;throw new Error(e)};if(t.mixin({beforeCreate:function(){var t=this,e=this.$options.methods||{};Object.keys(e).forEach((function(r){var o=e[r];t.$options.methods[r]=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var i=o.apply(this,e);return i&&"function"==typeof i.catch?i.catch(n):i}}))}}),t.config.errorHandler){var o=t.config.errorHandler;t.config.errorHandler=function(t,e,n){var i=p.apply(null,[t,e,n]);r.report(i),o.call(this,t,e,n)}}else t.config.errorHandler=function(t,e,n){var o=p.apply(null,[t,e,n]);r.report(o)}},t}(),l=function t(e){var r=e.usage,n=t.shatterSupport,o=[];"all"===r?o.push.apply(o,Object.keys(n)):Array.isArray(r)?o.push.apply(o,r):"string"==typeof r?o.push(r):o.push("ErrorForShatter"),o.forEach((function(t){new n[t](e)}))};return l.shatterSupport={ErrorForShatter:a,PerformanceForShatter:s,BehaviorForShatter:c},t.BehaviorForShatter=c,t.ErrorForShatter=a,t.PerformanceForShatter=s,t.ShatterErrorVue=u,t.ShatterInit=l,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
