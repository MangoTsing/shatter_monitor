var shatter=function(t){"use strict";function e(t){return Object.prototype.toString.call(t).indexOf("Error")>-1}var r,o;!function(t){t.JAVASCRIPT_ERROR="JAVASCRIPT_ERROR",t.BUSINESS_ERROR="BUSINESS_ERROR",t.LOG_ERROR="LOG_ERROR",t.FETCH_ERROR="HTTP_ERROR",t.RESOURCE_ERROR="RESOURCE_ERROR",t.PROMISE_ERROR="PROMISE_ERROR",t.VUE_ERROR="VUE_ERROR"}(r||(r={})),function(t){t.jsError="JS_ERROR",t.sourceError="SOURCE_ERROR",t.promiseError="UNHANDLEDREJECTION",t.consoleError="CONSOLE_ERROR",t.ajaxError="AJAX_ERROR",t.fetchError="FETCH_ERROR",t.VueError="VueError"}(o||(o={}));var n=function(){function t(t){this.options=t}return t.prototype.beforeSendData=function(t){if(!this.options.beforeSendData)return!0;try{return this.options.beforeSendData(t)}catch(t){throw t}},t}();function i(t){var e=t.substr&&t.substr(0,5);return e?"https"===e?"https":"http:"===e?"http":"other":"unknown"}var s=function(){function t(t){this.sendType="img",this.options=t,this._init()}var s=t.prototype;return s._init=function(){var t=this,s=this.options,a=s.blockConsole,c=s.blockPromise,p=s.blockError,u=s.blockSource,l=s.blockXhr,f=s.blockFetch,h=s.blockTry,R=s.blockHttpRequest,E=s.onlyHttpRequest;this.hooks=new n(s),window.navigator&&window.navigator.sendBeacon&&!s.onlyImg&&(this.sendType="beacon"),E||function(t,n){if(!n.blockTry){var i=EventTarget.prototype.addEventListener,s=EventTarget.prototype.removeEventListener,a=[];EventTarget.prototype.addEventListener=function(t,e,r){var o=function(){try{return e.apply(this,arguments)}catch(t){throw t}};return a.push({origin:e,wrap:o}),i.call(this,t,o,r)},EventTarget.prototype.removeEventListener=function(t,e,r){var o;return a.some((function(t){return t.origin===e&&(o=t.wrap,!0)}))?s.call(this,t,o,r):s.call(this,t,e,r)}}if(!n.blockError){var c=window.onerror||null;window.onerror=function(e,n,i,s,a){t.report({name:o.jsError,msg:e,url:n,line:i,col:s,type:r.JAVASCRIPT_ERROR}),c&&c(e,n,i,s,a)}}if(n.blockSource||window.addEventListener("error",(function(e){if(e){var n=e.target||e.srcElement;if(!(n instanceof HTMLScriptElement||n instanceof HTMLLinkElement||n instanceof HTMLImageElement))return!1;var i=n.src||n.href;t.report({name:o.sourceError,url:i,type:r.RESOURCE_ERROR})}}),!0),n.blockPromise||window.addEventListener("unhandledrejection",(function(e){if(e.reason&&e.reason.stack&&e.reason.stack.includes("\n")){var n=e.reason.stack.split("\n")[1].split("at ")[1],i=n.split(":"),s=i[i.length-2],a=i[i.length-1],c=n&&n.slice(0,-s.length-a.length-2),p=e.reason.message;t.report({name:o.promiseError,msg:p,url:c,line:s,col:a,type:r.PROMISE_ERROR})}else t.report({name:o.promiseError,type:r.PROMISE_ERROR,msg:e.reason&&e.reason.stack||e.reason||""})}),!0),!n.blockConsole){var p=window.console.error;window.console.error=(u=p,function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];i.forEach((function(n){if(e(n)){var i,s=(i=n.stack&&n.stack.split("\n")[1]?n.stack&&n.stack.split("\n")[1].split("at ")[1]:n.stack).split(":"),a=s[s.length-2],c=s[s.length-1],p=i.split("(")[1]&&i.split("(")[1].slice(0,-a.length-c.length-2)||"anonymousFunction";t.report({name:o.consoleError,msg:n.stack,url:p,line:a,col:c,type:r.LOG_ERROR})}else t.report({name:o.consoleError,msg:n,type:r.LOG_ERROR})})),u.apply(console,i)})}var u}(this,{blockConsole:a,blockPromise:c,blockError:p,blockSource:u,blockTry:h}),R||(l||function(t){if(window.XMLHttpRequest){var e=window.XMLHttpRequest,r=e.prototype.send,o=e.prototype.open,n=function(e,r,o,n){e&&e.currentTarget&&200!==e.currentTarget.status&&t&&t(e,r,o,n)};e.prototype.open=function(){var t=arguments;return this._openArgs=t,this._openTime=(new Date).getTime(),o.apply(this,t)},e.prototype.send=function(){var t=arguments;if(this.addEventListener)this.addEventListener("error",(function(e){n(e,t,this._openArgs,this._openTime)})),this.addEventListener("load",(function(e){n(e,t,this._openArgs,this._openTime)})),this.addEventListener("abort",(function(e){n(e,t,this._openArgs,this._openTime)}));else{var e=this.onreadystatechange;this.onreadystatechange=function(r){4===this.readyState&&n(r,t,this._openArgs,this._openTime),e&&e.apply(this,t)}}return r.apply(this,t)}}}((function(e,n,s,a){var c=e.currentTarget,p=c.responseURL,u=(new Date).getTime()-a;t.report({name:o.ajaxError,url:p,type:r.FETCH_ERROR,fetchTimeline:u,request:{method:s[0],httpType:i(p),data:n&&n[0]||""},response:{status:c.status,data:c.statusText}})})),f||function(t,e){if(window.fetch){var r=window.fetch;window.fetch=function(){var o=arguments,n=(new Date).getTime();return r.apply(this,o).then((function(e){return e.ok||t&&t(e,o,n),e})).catch((function(t){throw e&&e(t.toString(),o,n),t}))}}}((function(e,n,s){e.text().then((function(a){var c=e.url||n[0],p=(new Date).getTime()-s;t.report({name:o.fetchError,url:c,msg:e.statusText,type:r.FETCH_ERROR,fetchTimeline:p,request:{httpType:i(c),method:n[1].method,data:n[1].body||""},response:{status:e.status,data:a||e.statusText}})}))}),(function(e,n,s){var a=i(n[0]),c=(new Date).getTime()-s;t.report({name:o.fetchError,msg:e,url:n[0],fetchTimeline:c,type:r.FETCH_ERROR,request:{httpType:a,data:n[1].body,method:n[1].method}})})))},s.report=function(t){var e=(t||this.options).dsn,r=this.options.appkey;if(Object.assign(t,{_t:(new Date).getTime(),appkey:r}),!this.hooks.beforeSendData(t))return!1;var o,n,i=(o=t,Object.entries(o).reduce((function(t,e,r){var o=e[0],n=e[1];return"object"==typeof n&&(n=JSON.stringify(n)),0!==r&&(t+="&"),t+=o+"="+encodeURIComponent(n)}),""));this.options.debug?console.log("log to : "+e+"?"+i):"img"===this.sendType?(n=e+"?"+i,(new Image).src=n):"beacon"===this.sendType&&function(t,e){if(void 0===e&&(e="formData"),"formData"===e){var r=new FormData;for(var o in t)if("dsn"!==o){var n=t[o];"object"==typeof n&&(n=JSON.stringify(n)),r.append(o,n)}window.navigator.sendBeacon(t.dsn,r)}}(Object.assign(t,{dsn:e}))},t}(),a=function(){function t(){console.log("performance")}return t.prototype.init=function(){console.log("performance init")},t}(),c=function(){function t(){console.log("behavior")}return t.prototype.init=function(){console.log("behavior init")},t}();function p(t,e,n){var i=function(t){if(t.$root===t)return"root";var e=t._isVue?t.$options&&t.$options.name||t.$options&&t.$options._componentTag:t.name;return(e?"component <"+e+">":"anonymous component")+(t._isVue&&t.$options&&t.$options.__file?" at "+(t.$options&&t.$options.__file):"")}(e),s=e.$options&&e.$options.propsData;return{type:r.VUE_ERROR,msg:t.message+"("+n+")",url:"undefined"==typeof document||null==document.location?"":document.location.href,componentName:i,propsData:s||"",name:o.VueError,stack:t.stack||[]}}var u=function(){function t(){}return t.install=function(t,r){var o=new s(r);t.config.globalProperties?t.config.globalProperties.$report=o.report:t.prototype.$report=o.report;var n=function(t){var r;if("object"==typeof t){if(e(t))throw t;r=JSON.stringify(t)}else r=t;throw new Error(r)};if(t.mixin({beforeCreate:function(){var t=this,e=this.$options.methods||{};Object.keys(e).forEach((function(r){var o=e[r];t.$options.methods[r]=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var i=o.apply(this,e);return i&&"function"==typeof i.catch?i.catch(n):i}}))}}),t.config.errorHandler){var i=t.config.errorHandler;t.config.errorHandler=function(t,e,r){var n=p.apply(null,[t,e,r]);o.report(n),i.call(this,t,e,r)}}else t.config.errorHandler=function(t,e,r){var n=p.apply(null,[t,e,r]);o.report(n)}},t}(),l=function t(e){var r=e.usage,o=t.shatterSupport,n=[];"all"===r?n.push.apply(n,Object.keys(o)):Array.isArray(r)?n.push.apply(n,r):"string"==typeof r?n.push(r):n.push("ErrorForShatter"),n.forEach((function(t){new o[t](e)}))};return l.shatterSupport={ErrorForShatter:s,PerformanceForShatter:a,BehaviorForShatter:c},t.BehaviorForShatter=c,t.ErrorForShatter=s,t.PerformanceForShatter=a,t.ShatterErrorVue=u,t.ShatterInit=l,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
